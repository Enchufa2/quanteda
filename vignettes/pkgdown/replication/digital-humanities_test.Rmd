---
title: "Replication: Text Analysis with R for Students of Literature"
author: Kenneth Benoit, Stefan MÃ¼ller, and Paul Nulty
output: 
  html_document:
    toc: true
---

```{r message=FALSE}
library("quanteda")
library("stringi")
load("data_char_mobydick.rda")
```

```{r}
corp <- corpus(data_char_mobydick)
#corp <- corpus_segment(corp, "CHAPTER", pattern_position = "before", case_insensitive = FALSE)
```

```{r}
toks <- tokens(corp)
toks_lower <- tokens_tolower(toks)
```

```{r}
#xtoks <- as.tokens_xptr(toks)
type <- types(toks)
pat <- "whale*"
#quanteda_options(threads = 8)
out <- quanteda:::index_types(pat, type, "glob")
```

```{r, eval=FALSE}
conc <- attributes(xtoks)$meta$object$concatenator
ids <- object2id(pat, type, case_insensitive = TRUE, concatenator = conc)
print(ids)
head(quanteda:::cpp_index(xtoks, ids))
```

```{r, eval=FALSE}
#ERROR?
nrow(index(toks_lower, pattern = "whale"))
nrow(index(toks_lower, pattern = "whale*")) # includes words like "whalemen"
```

```{r, eval=FALSE}
# same thing using kwic()
nrow(kwic(toks_lower, pattern = "whale"))
nrow(kwic(toks_lower, pattern = "whale*")) # includes words like "whalemen"
```
